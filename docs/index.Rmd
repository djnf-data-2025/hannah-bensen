---
title: "Hannah Bensen - Investigative Reporting Workshop"
output: html_document
date: "2025-05-02"
editor_options: 
  markdown: 
    wrap: sentence
---

A demo notebook for Dow Jones News Fund data interns

During the week’s training, you will work on a project called Investigate Your Community to produce detailed story pitches relevant to their summer internship positions.
The goal is to have the students research a topic relevant to your newsroom so they can get to work immediately at the internship.

Here are some examples from last year’s DJNF data journalism training:

Hannah Rosenberger, at ASI Media/Counselor magazine, produced this analysis on name, image and likeness trends: <https://hrosenberger.github.io/ASI-NIL-Project/>

Shifra Dayak, an intern at the Connecticut Mirror, produced this analysis of environment spill data: <https://shifradayak.github.io/DJNF_Merrill/ct_env_spills.html>.

Michael Zhang, an intern at the Houston Landing, explored local election data: <https://michaelzhangreporter.github.io/Houston_Campaign_Finance/>

Here's what your newsroom suggested for a project I'm afraid we don't have a specific data set or topic for Hannah Bensen to examine.
We're continuing to work on projects related to long-term health effects of lead and government accountability related to cleanup regarding lead paint.
We also have several police-use-of-force stories underway and are nearing completion on one related to police-surveillance tools and analytics.
Aarushi has talked to Hannah about the pitch process and our interests so Hannah may be looking into a few ideas.

Blood Lead Levels (µg/dL) among U.S.
Children \<72 Months of Age, by State, Year, and Blood Lead Level (BLL)

This notebook helps you get started

# Story Pitch


*What the story's about:* This story is about trend in children Blood Lead Levels (BLL) in the last few years. While BLL levels have generally trended down in the last few decades, thousands of children across all states still suffer from elevated BLL levels. 

The Centers for Disease Control and Prevention (CDC) has found that even a low blood lead level (BLL) can cause lifelong health effects. Up until 2012, 10 micrograms of lead per deciliter of blood (µg/dL) was used to indicate that a child’s BLL was of concern. Since then, research has shown that cognitive and behavioral issues can occur in children with BLLs greater than or equal to 5 µg/dL, making it the new reference number to identify children who have been exposed to lead and require case management. However, few states test many children for elevated BLL - many states only test 25% of children or less. 

*Why now:* I'm not sure - still need to explore this. 

*Three sources:* TBD. 

*Potential Impact:* Still exploring this, but elevated BLL levels in children can result in lower IQ, lifetime earnings, and other negative consequences. 

*Things that surprised me/findings:* 

The states with the biggest percentage point drops in children with BLL above 5 ug/dl from 2017 to 2021 are Kansas, Louisiana, Illinois, Alaska, and Wisconsin. As I wrote this, it occurred to me that these are *percentage point* differences and not *percent* differences; I might consider highlighting the latter. Thoughts? 

Only 4 states (Mississippi, West Virginia, New Jersey, Delaware) had an increase in BLL levels in that timeframe. 

I think it would be interesting to consider what factors might be driving the decrease in BLL levels in the above timeframe. 


*Context:* Generally speaking, the factors driving declining BLL levels in children in states across the country are driven by a combination of successful federal regulations, dedicated state and local prevention programs, improved surveillance and case management, and increased public awareness regarding lead exposure and prevention. 

*Visualizations:*
I currently have two charts: 
-A line chart showing the states with the biggest decline and biggest increase children above a certain BLL treshold considered harmful by the CDC. 
-A choropleth map showing BLL levels by state. 


However, I don't think the line chart is that compelling. I welcome your feedback on how to make it more interesting. The choropleth map is nice-ish, but data are missing from a lot of states, making it pretty bare. Further, the states with the highest percent of children over the 5 ug/dl BLL threshold (Rhode Island and New Jersey) are really small and hard to see on the map. I welcome your feedback on how to make this visualization more compelling, too. 

# Analysis of results, next steps

# Load software libraries

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
#install.packages("tidyverse")
#install.packages("janitor")
#install.packages("readxl")
#install.packages("rvest")
#install.packages("viridis")
library(tidyverse)
library(janitor)
library(readxl)
library(rvest)
library(ggplot2)
library(dplyr)
library(viridis)
library(maps)


```

# Load your data

2024

```{r message=FALSE, warning=FALSE, paged.print=FALSE}

# 
# YOUR_DATA <- read.csv("../data/XXXXX.csv") |> 
#     clean_names()

# data1 <- read_excel("../data/cbls-national-data-508.xlsx", skip=2, n_max = 270) |>
#      clean_names()

df_raw <- read_excel("../data/cbls-national-data-508.xlsx", skip =2, n_max = 270)
  
  



```

Data details: <https://www.cdc.gov/lead-prevention/php/data/national-surveillance-data.html> BLL - Blood Lead Level, SD - Indicates non-zero counts fewer than 6 have been suppressed to protect confidentiality\
† - Partial annual data submission\
\* - Indicates program did not receive childhood lead poisoning prevention funding from CDC\
‡ - Indicates data not currently available\
ǁ - Includes all popluation data in table\
Population estimates data source: CDC NCHS Bridged Race Single Year of Age population (U.S. Census Populations With Bridged Race Categories <https://www.cdc.gov/nchs/nvss/bridged_race.htm#data>).\
- For years 2017-2019, the data use each respective Vintage year for the denominator data (e.g., 2017 data uses the 2017 Vintage bridged race postcensal population estimates).\
- For years 2020-2021, due to data availability at the time of processing, Vintage 2020 was used for data years 2020 and 2021.\
- This will be updated with future data updates to align with pre-2020 years (e.g., 2021 data will use the 2021 Vintage postcensal population estimates, etc.).\
The current Blood Lead Reference Value of 3.5 µg/dL was enacted by CDC in October 2021.
Categorizations of blood lead levels above and below this value will be used in blood lead surveillance tables starting with 2022 data.

From ChatGPT: According to the Centers for Disease Control and Prevention (CDC), any blood lead level (BLL) of 5 µg/dL or higher is considered elevated and requires public health actions.

Here's a summary of the danger zones based on the image and your description:

BLLs ≥5 µg/dL: This is the threshold where lead exposure becomes concerning and may require intervention.
BLLs ≥10 µg/dL: This level indicates more significant lead exposure and is considered dangerous.
BLLs 5-9 µg/dL: While lower than 10 µg/dL, this range is still concerning and above the CDC's reference level.
BLLs 10-14 µg/dL: This is a dangerous zone and indicates elevated lead exposure.
BLLs 15-19 µg/dL: This level is considered dangerous and requires intervention.
BLLs 20-24 µg/dL: This is a dangerous level of lead exposure.
BLLs 25-44 µg/dL: This is a significantly dangerous level and poses serious health risks.
BLLs ≥45 µg/dL: This is extremely dangerous and requires immediate medical attention.

# Clean data

```{r message=FALSE, warning=FALSE}
 df_5BLL <- df_raw %>% 
  #Make Year numeric
  mutate(Year = as.numeric(str_extract_all(Year, "[0-9]+"))) %>% 
  #Select key variables
  select(c(Year, State, "Percent of Children with Confirmed BLLs ≥5 µg/dL")) %>%
  #Rename key variable
  rename(BLL5 = "Percent of Children with Confirmed BLLs ≥5 µg/dL") %>%
  #Make BLL variable numeric
  mutate(BLL5 = as.numeric(str_remove(BLL5, "%"))) 


```



# Data exploration: states with most dangerous levels

The states with the highest percentage of children with confirmed BLL over the 5 µg/dL in 2021 are: Rhode Island, New Jersey, New Hampshire, Wisconsin, and Connecticut

```{r}
df_5BLL %>%  
  #Filter for most recent year in dataset
  filter(Year == 2021) %>% 
  #Remove rows with missing values
  subset(!is.na(BLL5)) %>% 
  arrange(desc(BLL5)) 
```

# Questions

Write down questions you want answered:

What are the states that had the biggest decrease over 5 years - from 2017 to 2021 - in  percentage of children with confirmed BLL over the 5 µg/dL? 
```{r}
df_BLL_wide <- df_5BLL %>% 
  #Widen df
  pivot_wider(names_from = "Year", 
              values_from = "BLL5") %>% 
  #select State and first and last year
  select(State, "2017", "2021") %>% 
  #Drop missing values
  drop_na("2017", "2021") %>% 
  #Calculate difference between 2021 and 2017
  mutate(diff_5BLL = `2021` - `2017`) %>% 
  arrange(diff_5BLL)

```

#These states had the biggest decline in percentage of children with confirmed BLL over 5 µg/dL from 2017 to 2021
```{r}
head(df_BLL_wide, 5)  # Display the first 5 rows

```
#These states had the biggest increase in percentage of children with confirmed BLL over 5 µg/dL from 2017 to 2021
```{r}
tail(df_BLL_wide, 4)  # Display the last 5 rows
```


```{r}
#Plot the states with biggest decrease and biggest decrease
df_5BLL %>% 
  filter(State %in% c( #Biggest decrease states
                      "Kansas","Louisiana", "Illinois", "Alaska", "Wisconsin",
                      #Biggest increase states
                      "Mississippi", "West Virginia", "New Jersey", "Delaware" )) %>% 
  ggplot(aes(x = Year, y = BLL5, color = State)) + 
  geom_line()+ 
  ggtitle("States with elevated Blood Lead Levels for Children") + 
  xlab("Year") + ylab("Percent of Children with Confirmed BLLs ≥5 µg/dL") + 
  theme_minimal()
```

```{r}
df_map <-  df_5BLL %>% 
  filter(Year == 2021) %>% 
  mutate(State = tolower(State))
  

```


```{r}
states_map <- map_data("state")  # if using ggplot2::map_data
map_data <- states_map %>%
  left_join(df_map, by = c("region" = "State")) 

```

```{r}

ggplot(map_data, aes(x = long, y = lat, group = group, fill = BLL5)) +
  geom_polygon(color = "white") +
  scale_fill_gradient(low = "lightyellow", high = "darkred", na.value = "gray90") +
  labs(title = "Children with Elevated Blood Lead Level by State (2021)",
       fill = "% Children With Elevated BLL") +
  coord_fixed(1.3) +
  theme_minimal() + 
   xlab("") + ylab("")
```


# Data Details (written by Rob)

I'd consider converting the SD to 1 and running a sum for all levels above 10 ug/dl.
"SD - Indicates non-zero counts fewer than 6 have been suppressed to protect confidentiality." So SD equals something between 1 and 6.
Converting to 1 would be a conservative estimate

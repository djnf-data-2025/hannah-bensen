---
title: "What Lead Left Behind"
author: "Hannah Bensen hannahbensen7@gmail.com"
output: html_document
date: "2025-06-07"
editor_options: 
  markdown: 
    wrap: sentence
---

Though child Blood Lead Levels (BLL) have trended down in the in the last few decades, the CDC [estimates](https://www.cdc.gov/lead-prevention/php/news-features/updates-blood-lead-reference-value.html#:~:text=The%20BLRV%20is%20a%20population,the%20need%20for%20exposure%20prevention.) that around 500,000 children  U.S. children aged 1-5 (about 2.5% of this population) suffer from elevated BLL levels, defined as greater than 3.5 ug/dL.

Elevated BLL in children can result in lower IQ, learning capacity, lifetime earnings, and other negative consequences. Further, lead-based paint poisoning - one of the most common sources of elevated BLL -  is a preventable hazard that is highly related to historical inequities in housing policy. 

<iframe title="Percent of Young Children with Elevated Blood Lead Level, 2021" aria-label="Map" id="datawrapper-chart-J8tPH" src="https://datawrapper.dwcdn.net/J8tPH/4/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="576" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
</script>

<br>
This story will evaluate Blood Lead Levels in specific states of interest including Maryland. It will consider how BLL is trending in different states and whether these trends are tied to a specific geography (such as Baltimore) a specific demographic group (such as Black communities or low-income people), or a particular source of lead (such as lead-based paint, industrialization, or environmental factors). <br>

The state of Maryland has BLL data at the county level for 2023. 

<br><br>

<div style="min-height:400px" id="datawrapper-vis-q5PAp"><script type="text/javascript" defer src="https://datawrapper.dwcdn.net/q5PAp/embed.js" charset="utf-8" data-target="#datawrapper-vis-q5PAp"></script><noscript><img src="https://datawrapper.dwcdn.net/q5PAp/full.png" alt="" /></noscript></div>
<br>
<br>


This story will also evaluate the efficacy of federal and state lead-abatement programs. Maryland, for example, has a few initiatives designed to track and mitigate child lead exposure: 

1. A **mandatory lead testing program** implemented by state law in 2015 and 2016 requires all children at 12 months and 24 months to be tested for lead. This initiative has resulted in a much higher percentage (around 80%) lead testing requirement, resulting in much more complete datasets. Many states do not have mandatory lead testing and thus suffer from a lack of available data or data quality issues. 
2. Maryland has a [Healthy Homes](https://health.maryland.gov/phpa/OEHFP/EH/pages/healthy-homes.aspx) program focuses on identifying and eliminating health hazards for all residents. Maryland also has a [program](https://health.maryland.gov/phpa/OEHFP/EH/Pages/LeadHomeVisiting.aspx) that helps families who have children with BLL > 3.5 ug/dL remove lead from their homes at no cost to the homeowner or resident. *Possible story angle: Are these programs effective? Why or why not? How do different state initiatives compare to one another, and which are most effective?*
3. [Maryland's Reduction of Lead Risk in Housing Act](https://www.peoples-law.org/lead-paint-law-information-owners-and-sellers#landlord-duties) requires landlords who rent pre-1978 dwellings to register their properties, fulfill lead-free certification requirements, and pass a Lead Free inspection each time a tenant changes. *Possible story angle: Are landlords complying with this regulation? If not, which populations are being disproportionately impacted?* 




**Note that for the purpose of this pitch, I will consider 5 µg/dL to be the threshold for "elevated" BLL because the CDC data only had data for 5 ug/dL and above for 2017 - 2021.** 

*Context*<br> The Centers for Disease Control and Prevention (CDC) has found that even a low blood lead level (BLL) can cause lifelong health effects. Before 2012, at or greater than **10 µg/dL** was the threshold for public intervention. was used to indicate that a child’s BLL was of concern. In 2012, the thresohold was changed to **5 ug/dL**, and in 2021, **3.5 ug/dL** became the new reference number. There is no safe level of lead in blood for children, the CDC says. <br>




*Why now?*<br> Children's health and public health is always newsworthy. Further, federal budget cuts of health monitoring leads to more ambiguity around the causes and impacts of elevated BLL. Maryland's department of the environment webpage, for example - which ostensibly was the place to obtain Maryland's child blood lead level data - is not usable at the moment due to federal budget cuts. 




```{r echo=FALSE, out.width='50%'}
#Marylands data warning on their website
knitr::include_graphics("/Users/hannahbensen/code/hannah-bensen/data/data_warning.png")
```
<br>Maryland’s data warning on their website.

*Three sources* <br>
1. The Maryland Department of Environment's Lead Registry Annual Surveillance Report contains data for Maryland on blood lead tests done in the state. Reports go back until at least 2010, if not earlier. [Here](https://mde.maryland.gov/programs/land/LeadPoisoningPrevention/Documents/2023%20MDE%20Lead%20Poisoning%20Prevention%20Program%20Surveillance%20Report.pdf) is the 2023 report.\
2. The Maryland Department of Health released a [2022 Report](https://health.maryland.gov/phpa/OEHFP/EH/Documents/MDLeadTestingEvaluation_122022.pdf) evaluating the policy impact of Maryland's universal childhood blood lead testing requirement. The report also provides useful information on what Maryland is doing to mitigate elevated blood levels, the impact of lead in children, and sources of lead in Maryland (mainly lead paint from pre-1979 homes)\
3. A Congressional Research Service report from 2013 titled "[Lead-Based Paint Poisoning Prevention: Summary of Federal Mandates and Financial Assistance for Reducing Hazards in Housing](https://www.congress.gov/crs-product/RS21688?q=%7B%22search%22%3A%22blood+lead+level%22%7D&s=1&r=8)" outlines federal legislative efforts to mitigate lead-based paint poisoning. 


*Potential Impact*<br> Elevated BLL levels in children can result in lower IQ, lifetime earnings, and other negative consequences. According to Maryland's department of health report, lead paint is a preventable hazard that is "highly related to historical inequities in housing policy." This story could impact policy if localities are not complying with state and federal law. <br>

It will also spotlight factors or policies driving the decrease in BLL levels in the above timeframe. Generally speaking, the factors driving declining BLL levels in children in states across the country are driven by a combination of successful federal regulations, dedicated state and local prevention programs, improved surveillance and case management, and increased public awareness regarding lead exposure and prevention. <br>

*Surprising Findings*<br>

The states with the biggest percentage drops in children with BLL at or above 5 ug/dl from 2017 to 2021 are the following. Only two states - Florida and South Carolina - saw an increase in the percentage of children with elevated BLL between 2017 and 2021. 

<iframe title="Percent change in elevated Blood Lead Levels for Children, 2017 to 2021" aria-label="Bar Chart" id="datawrapper-chart-miNtP" src="https://datawrapper.dwcdn.net/miNtP/2/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="509" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
</script>

The states with the highest *number* of children with elevated BLL are shown below. Note that states with a bigger population will have a higher number of children with elevated BLL. <br>
<iframe title="States with highest number of children with elevated Blood Lead Level in 2021" aria-label="Bar Chart" id="datawrapper-chart-5bKJQ" src="https://datawrapper.dwcdn.net/5bKJQ/1/" scrolling="no" frameborder="0" style="width: 0; min-width: 100% !important; border: none;" height="380" data-external="1"></iframe><script type="text/javascript">!function(){"use strict";window.addEventListener("message",(function(a){if(void 0!==a.data["datawrapper-height"]){var e=document.querySelectorAll("iframe");for(var t in a.data["datawrapper-height"])for(var r,i=0;r=e[i];i++)if(r.contentWindow===a.source){var d=a.data["datawrapper-height"][t]+"px";r.style.height=d}}}))}();
</script>

The states with the highest *percentage* of children with BLL at or above 5 ug/dL in 2021 are:\
1. Rhode Island \
2. New Jersey\
3. Wisconsin\
4. New Hampshire\
5. Connecticut\



# Analysis

# Load software libraries

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
#install.packages("tidyverse")
#install.packages("janitor")
#install.packages("readxl")
#install.packages("rvest")
#install.packages("viridis")
library(tidyverse)
library(janitor)
library(readxl)
library(rvest)
library(ggplot2)
library(dplyr)
library(viridis)
library(maps)
library(ellmer)


```

# Load your data

2024 CBLS Data

```{r message=FALSE, warning=FALSE, paged.print=FALSE}

 df_raw <- read_excel("../data/cbls-national-data-508.xlsx", skip=2, n_max = 270) %>% 
      clean_names()

#df_raw <- read_excel("../data/cbls-national-data-508.xlsx", skip =2, n_max = 270)
  
  



```


```{r eval=FALSE, include=FALSE}
# Data details: <https://www.cdc.gov/lead-prevention/php/data/national-surveillance-data.html> BLL - Blood Lead Level, SD - Indicates non-zero counts fewer than 6 have been suppressed to protect confidentiality\
# † - Partial annual data submission\
# \* - Indicates program did not receive childhood lead poisoning prevention funding from CDC\
# ‡ - Indicates data not currently available\
# ǁ - Includes all popluation data in table\
# Population estimates data source: CDC NCHS Bridged Race Single Year of Age population (U.S. Census Populations With Bridged Race Categories <https://www.cdc.gov/nchs/nvss/bridged_race.htm#data>).\
# - For years 2017-2019, the data use each respective Vintage year for the denominator data (e.g., 2017 data uses the 2017 Vintage bridged race postcensal population estimates).\
# - For years 2020-2021, due to data availability at the time of processing, Vintage 2020 was used for data years 2020 and 2021.\
# - This will be updated with future data updates to align with pre-2020 years (e.g., 2021 data will use the 2021 Vintage postcensal population estimates, etc.).\
# The current Blood Lead Reference Value of 3.5 µg/dL was enacted by CDC in October 2021.
# Categorizations of blood lead levels above and below this value will be used in blood lead surveillance tables starting with 2022 data.
# 
# From ChatGPT: According to the Centers for Disease Control and Prevention (CDC), any blood lead level (BLL) of 5 µg/dL or higher is considered elevated and requires public health actions.
# 
# Here's a summary of the danger zones based on the image and your description:
# 
# BLLs ≥5 µg/dL: This is the threshold where lead exposure becomes concerning and may require intervention.
# BLLs ≥10 µg/dL: This level indicates more significant lead exposure and is considered dangerous.
# BLLs 5-9 µg/dL: While lower than 10 µg/dL, this range is still concerning and above the CDC's reference level.
# BLLs 10-14 µg/dL: This is a dangerous zone and indicates elevated lead exposure.
# BLLs 15-19 µg/dL: This level is considered dangerous and requires intervention.
# BLLs 20-24 µg/dL: This is a dangerous level of lead exposure.
# BLLs 25-44 µg/dL: This is a significantly dangerous level and poses serious health risks.
# BLLs ≥45 µg/dL: This is extremely dangerous and requires immediate medical attention.

```




# Obtain data
```{r}
#Upload screenshot of Maryland's Blood Level Level data from their 2023 Lead Registry Report
BLL23 <- google_upload(path = "/Users/hannahbensen/code/hannah-bensen/data/BLL_2023.png")
```


```{r echo=TRUE}
#Use LLM to extract data from 2023 Maryland surveillance report
#Commented out becuase I copy the output into a dataframe in a code chunk below. 
# Set the model BLL_2023.png
# gemini_chat <- chat_google_gemini(model="gemini-2.5-flash-preview-04-17")
# 
# extract_csv_gemini <- gemini_chat$chat("Could you extract the table called Table Five: Blood Lead Testing of Children 0-72 Months by Jurisdiction from this link? No yapping, just export the data such that it can be used in an R dataframe", BLL23)

```



```{r}
#Copy output from LLM into R, clean dataframe 

text_data <- "
County,Population of Children,Number Tested,Percent Tested,Blood Lead Level >=5 ug/dL Incidence Number,Blood Lead Level >=5 ug/dL Incidence Percent,Blood Lead Level >=5 ug/dL Prevalence Number,Blood Lead Level >=5 ug/dL Prevalence Percent,Blood Lead Level 5-9 ug/dL Incidence Number,Blood Lead Level 5-9 ug/dL Incidence Percent,Blood Lead Level 5-9 ug/dL Prevalence Number,Blood Lead Level 5-9 ug/dL Prevalence Percent,Blood Lead Level >=10 ug/dL Incidence Number,Blood Lead Level >=10 ug/dL Incidence Percent,Blood Lead Level >=10 ug/dL Prevalence Number,Blood Lead Level >=10 ug/dL Prevalence Percent
Allegany,3280,1227,37.4,47,1.4,31,0.9,36,1.1,23,0.7,11,0.3,8,0.2
Anne Arundel,37364,10673,28.6,72,0.2,27,0.1,68,0.2,24,0.1,4,0.0,3,0.0
Baltimore,50559,17535,34.7,186,0.4,82,0.2,143,0.3,56,0.1,43,0.1,26,0.1
Baltimore City,35556,13859,39.0,363,1.0,195,0.5,297,0.8,153,0.4,66,0.2,42,0.1
Calvert,5429,1327,24.4,4,0.1,3,0.1,3,0.1,2,0.0,1,0.0,1,0.0
Caroline,2262,701,31.0,7,0.3,3,0.1,5,0.2,3,0.1,2,0.1,0,0.0
Carroll,10318,3113,30.2,51,0.5,23,0.2,41,0.4,13,0.1,10,0.1,10,0.1
Cecil,6305,1640,26.0,37,0.6,10,0.2,32,0.5,9,0.1,5,0.1,1,0.0
Charles,10291,2921,28.4,24,0.2,6,0.1,19,0.2,6,0.1,5,0.0,0,0.0
Dorchester,1893,562,29.7,10,0.5,9,0.5,8,0.4,8,0.4,2,0.1,1,0.1
Frederick,18486,5685,30.8,37,0.2,20,0.1,26,0.1,16,0.1,11,0.1,4,0.0
Garrett,1289,255,19.8,2,0.2,1,0.1,1,0.1,0,0.0,1,0.1,1,0.1
Harford,14994,4547,30.3,27,0.2,16,0.1,22,0.1,13,0.1,5,0.0,3,0.0
Howard,18807,4274,22.7,36,0.2,21,0.1,28,0.1,15,0.1,8,0.0,6,0.0
Kent,786,200,25.4,5,0.6,3,0.4,3,0.4,2,0.3,2,0.3,1,0.1
Montgomery,63134,23308,36.9,147,0.2,70,0.1,106,0.2,51,0.1,41,0.1,19,0.0
Prince George's,56767,21134,37.2,134,0.2,51,0.1,111,0.2,45,0.1,23,0.0,6,0.0
Queen Anne's,29523,907,3.1,5,0.0,2,0.0,4,0.0,1,0.0,1,0.0,1,0.0
Saint Mary's,7464,2215,29.7,11,0.1,4,0.1,10,0.1,3,0.0,1,0.0,1,0.0
Somerset,1148,440,38.3,8,0.7,7,0.6,5,0.4,4,0.3,3,0.3,3,0.3
Talbot,1865,463,24.8,7,0.4,3,0.2,5,0.3,3,0.2,2,0.1,0,0.0
Washington,8863,2536,28.6,45,0.5,23,0.3,34,0.4,15,0.2,11,0.1,8,0.1
Wicomico,6811,2603,38.2,44,0.6,19,0.3,37,0.5,14,0.2,7,0.1,5,0.1
Worcester,2357,831,35.3,9,0.4,2,0.1,8,0.3,2,0.1,1,0.0,0,0.0
Statewide,371258,122956,33.1,1318,0.4,631,0.2,1052,0.3,481,0.1,266,0.1,150,0.0
"

bll_df <- read.csv(textConnection(text_data), check.names = FALSE)

#Select variables of interest
bll_chart <- bll_df %>% 
  select(County, 
         `Blood Lead Level >=5 ug/dL Incidence Percent`, 
         `Blood Lead Level 5-9 ug/dL Incidence Percent`, 
         `Blood Lead Level >=10 ug/dL Incidence Percent`
         ) %>% 
  mutate(County = case_when(
    County == "Saint Mary's" ~ "St. Mary's", 
    County == "Baltimore" ~ "Baltimore County", 
    TRUE ~ County))
  




```

```{r}
#Write dataframes
readr::write_csv(bll_df, file = "/Users/hannahbensen/code/hannah-bensen/data/BLL_2023.csv")
readr::write_csv(bll_chart, file = "/Users/hannahbensen/code/hannah-bensen/data/BLL_chart_2023.csv")
```


# Clean CBLS national data

```{r message=FALSE, warning=FALSE}
 df_5BLL <- df_raw %>% 
  #Make Year numeric 
  mutate(#replace all "SDs" with 1. "SD - Indicates non-zero counts fewer than 6 have been suppressed to protect confidentiality." So SD equals something between 1 and 6. Converting to 1 is a conservative estimate
         across(everything(), ~ifelse(. == "SD", 1, .)), 
         across(everything(), ~ifelse(. == "-", NA, .))) %>% 
  mutate(year = as.numeric(str_extract_all(year, "[0-9]+")), 
         across(-state, as.numeric)) %>% 
  rowwise() %>% # Apply the sum row by row
  mutate(min5BLL = sum(c(number_of_children_with_confirmed_bl_ls_5_mg_d_l, 
                         number_of_children_with_confirmed_bl_ls_10_mg_d_l,
                         number_of_children_with_confirmed_bl_ls_5_9_mg_d_l, 
                         number_of_children_with_confirmed_bl_ls_15_19_mg_d_l, 
                         number_of_children_with_confirmed_bl_ls_25_44_mg_d_l), na.rm = TRUE)) %>% 
  ungroup() %>% 
  mutate(min5BLL_pct = min5BLL/number_of_children_tested_72_months_of_age *100) %>% 
  #Select key variables
  select(c(year, state, min5BLL, min5BLL_pct, number_of_children_tested_72_months_of_age)) %>% 
  mutate(min5BLL = na_if(min5BLL, 0))


```





```{r}
# Calculate the percentage difference
df_diff <- df_5BLL %>%
  # Group by state so calculations are done independently for each state
  group_by(state) %>%
  # Use summarise to create new rows for each state with the calculated difference
  summarise(
    # Get the min5BLL value for 2017
    min5BLL_2017 = min5BLL[year == 2017],
    # Get the min5BLL value for 2021
    min5BLL_2021 = min5BLL[year == 2021],
    # Calculate the percentage difference
    # Formula: ((Value_2021 - Value_2017) / Value_2017) * 100
    # If either 2017 or 2021 value is NA, the difference will also be NA
    pct_diff = ((min5BLL_2021 - min5BLL_2017) / min5BLL_2017) * 100
  ) %>%
  # Ungroup the data frame if you plan to do further operations on the whole frame
  ungroup() %>% 
  filter(pct_diff != -100) %>% 
  arrange(pct_diff)


```


# Data exploration: states with most dangerous levels

The states with the highest percentage of children with confirmed BLL over the 5 µg/dL in 2021 are: Rhode Island, New Jersey, New Hampshire, Wisconsin, and Connecticut

```{r}
df_5BLL_2021 <- df_5BLL %>%  
  #Filter for most recent year in dataset
  filter(year == 2021) %>% 
  #Remove rows with missing values
  subset(!is.na(min5BLL_pct)) %>% 
  arrange(desc(min5BLL_pct)) %>% 
  mutate(min5BLL_pct = round(min5BLL_pct, 2))

df_5BLL_2021_top <- df_5BLL_2021 %>%
  select(state, min5BLL) %>% 
  arrange(desc(min5BLL)) %>% 
  filter(state != "U.S. Totals ǁ") %>% 
  head(10)
  

head(df_5BLL_2021, 10)
```

```{r}

readr::write_csv( df_5BLL_2021, file = "/Users/hannahbensen/code/hannah-bensen/data/5BLL_counts_and_percents_2021.csv")
readr::write_csv( df_5BLL_2021_top, file = "/Users/hannahbensen/code/hannah-bensen/data/5BLL_top10_5BLLcounts_2021.csv")
```



# Questions

Write down questions you want answered:

What are the states that had the biggest decrease over 5 years - from 2017 to 2021 - in percentage of children with confirmed BLL over the 5 µg/dL?

```{r}
df_BLL_wide_counts <- df_5BLL %>% 
  select(year, state, min5BLL) %>% 
  filter(min5BLL>0) %>% 
  #Widen df
  pivot_wider(names_from = "year", 
              values_from = "min5BLL") %>% 
  #select State and first and last year
  select(state, "2017", "2021") %>% 
  #Drop missing values
  drop_na("2017", "2021") %>% 
  #Calculate difference between 2021 and 2017
  mutate(diff_5BLL = `2021` - `2017`) %>% 
  arrange(diff_5BLL)

```

#These states had the biggest decline in percentage of children with elevated BLL (over 5 µg/dL) from 2017 to 2021 in terms of the count (so, biggest states will be overrepresented). 

```{r}
head(df_BLL_wide_counts, 5)  # Display the first 5 rows
```

#These two states had the biggest increase in percentage of children with elevated BL from 2017 to 2021 in terms of counts

```{r}
tail(df_BLL_wide_counts, 2)  # Display the last 5 rows
```
#A better way of looking at these data are in percent increases in declines. These states had the biggest percentage point declines in the number children with elevated BLL between 2017 and 2017. Two states - South Carolina and Florida - had a percent increase in the number of children with elevated BLL. 
```{r}
head(df_diff, 5)  # Display the last 5 rows
tail(df_diff, 2)  # Display the last 5 rows

```



```{r eval=FALSE, include=FALSE}
#Plot top 10 states with biggest decrease and biggest decrease in 

df_diff %>%
  arrange(pct_diff) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(state, pct_diff), y = -pct_diff)) +
  geom_bar(stat = 'identity', fill = "#99d8c9")+
  ggtitle("States with largest percentage decrease in elevated Blood Lead Levels for Children") +
  xlab("State") + ylab("Decline in elevated BLL from 2017 to 2021") +
  theme_minimal()
```

```{r}
df_diff_export <- df_diff %>% 
  select(state, pct_diff) %>% 
  arrange(pct_diff) %>%
  slice_head(n = 10) %>%
  bind_rows(df_diff %>% 
              select(state, pct_diff) %>% 
              arrange(desc(pct_diff)) %>% slice_head(n = 2)) %>% 
  mutate(pct_diff = round(pct_diff, 2))


```

```{r}
readr::write_csv( df_diff_export, file = "/Users/hannahbensen/code/hannah-bensen/data/states_with_highest_5BLL_percent.csv")
```


```{r eval=FALSE, include=FALSE}
df_map <-  df_5BLL %>% 
  filter(year == 2021) %>% 
  mutate(state = tolower(state))
  

```

```{r eval=FALSE, include=FALSE}
states_map <- map_data("state")  # if using ggplot2::map_data
map_data <- states_map %>%
  left_join(df_map, by = c("region" = "state")) 

```

```{r eval=FALSE, include=FALSE}

ggplot(map_data, aes(x = long, y = lat, group = group, fill = min5BLL_pct)) +
  geom_polygon(color = "white") +
  scale_fill_gradient(low = "lightyellow", high = "darkred", na.value = "gray90") +
  labs(title = "Children with Elevated Blood Lead Level by State (2021)",
       fill = "% Children With Elevated BLL") +
  coord_fixed(1.3) +
  theme_minimal() + 
   xlab("") + ylab("")

```





